<div class="bg-decoration"></div>

<header class="header">
  <div class="logo-container">
    <div class="logo">
      <i class="fas fa-laptop"></i>
    </div>
    <div>
      <h1 class="org-name">Amigos de Santa Cruz</h1>
      <p class="system-title">Sistema de Gestión de Equipos</p>
    </div>
  </div>
</header>

<main class="main-container">
  <div class="login-card">
    <div class="welcome-text">
      <h2 class="welcome-title">¡Bienvenido!</h2>
      <p class="welcome-subtitle">Ingresa tus credenciales para acceder al sistema</p>
    </div>

    <form [formGroup]="form" (ngSubmit)="submit()">
      <div class="form-group">
        <label for="email" class="form-label">Usuario o Email</label>
        <div class="input-container">
          <input
            id="email"
            type="email"
            class="form-input"
            placeholder="Ingresa tu usuario o email"
            formControlName="email"
            [ngClass]="{ 'error': isInvalid('email'), 'success': isValid('email') }"
          />
          <i class="fas fa-user input-icon"></i>
        </div>
        <div *ngIf="isInvalid('email')" class="error-message">
          <span *ngIf="form.get('email')?.errors?.['required']">El email es obligatorio.</span>
          <span *ngIf="form.get('email')?.errors?.['email']">Por favor, ingresa un email válido.</span>
        </div>
      </div>

      <div class="form-group">
        <label for="password" class="form-label">Contraseña</label>
        <div class="input-container">
          <input
            id="password"
            [type]="passwordFieldType"
            class="form-input"
            placeholder="Ingresa tu contraseña"
            formControlName="password"
            [ngClass]="{ 'error': isInvalid('password'), 'success': isValid('password') }"
          />
          <i class="fas fa-lock input-icon"></i>
          <i
            class="password-toggle"
            [ngClass]="passwordFieldType === 'password' ? 'fas fa-eye' : 'fas fa-eye-slash'"
            (click)="togglePasswordVisibility()"
          ></i>
        </div>
        <div *ngIf="isInvalid('password')" class="error-message">
          <span>La contraseña es obligatoria.</span>
        </div>
      </div>

      <div *ngIf="apiError" class="error-message api-error">
        {{ apiError }}
      </div>

      <button type="submit" class="login-button" [disabled]="loading">
        <ng-container *ngIf="!loading; else loadingState">
          <span>Iniciar Sesión</span>
        </ng-container>
        <ng-template #loadingState>
          <div class="loading-spinner"></div>
          <span>Iniciando sesión...</span>
        </ng-template>
      </button>

      <div class="forgot-password">
        <a href="#" class="forgot-link">¿Olvidó su contraseña?</a>
      </div>
    </form>
  </div>
</main>

<footer class="footer">
  <p>&copy; 2025 Amigos de Santa Cruz ONG - Sistema desarrollado por Cristian Mendoza</p>
</footer>
